    <%- layout("/layouts/boilerplate") %>

    <!-- GSAP Script -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"
        integrity="sha512-7eHRwcbYkK4d9g/6tD/mhkf++eoTHwpNM9woBxtPUBWm67zeAfFC+HrdoE2GanKeocly/VxeLvIqwvCdk7qScg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: 'Roboto', sans-serif;
            background-color: #f4f4f4;
        }

        /* Splash Screen Styles */
        #splashScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #mainContent {
            display: none;
        }

        .loaderPage {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            background: #007bff;
        }

        .wrapper {
            text-align: center;
            color: #ffffff;
        }

        .text-container {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .text {
            font-size: 4rem;
            font-weight: 700;
            line-height: 1.2;
            color: #ffffff;
            margin: 0;
        }

        #count {
            font-size: 3rem;
            font-weight: 700;
        }

        .count-container {
            margin-top: 1rem;
        }

        /* Bot icon styles */
        #bot-icon {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background-color: #007bff;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            color: white;
            font-size: 24px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            z-index: 999;
        }

        /* Bot iframe container */
        #bot-container {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 350px;
            height: 430px;
            display: none; /* Initially hidden */
            z-index: 999;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        #bot-container iframe {
            width: 100%;
            height: 100%;
            border-radius: 10px;
            border: none;
        }

        /* Listing Card Styles */
        .listing-card {
            background-color: #ffffff;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .listing-card:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .card-img-top {
            height: 200px;
            object-fit: cover;
        }

        .card-body {
            padding: 1rem;
        }

        .card-text {
            font-size: 1rem;
            color: #333;
        }
    </style>

    <body>
        <!-- Splash Screen -->
        <div id="splashScreen">
            <div class="loaderPage">
                <div class="wrapper">
                    <div class="text-container">
                        <h1 class="text">Let's</h1>
                        <h1 class="text">explore</h1>
                        <h1 class="text">together</h1>
                    </div>
                    <div class="count-container">
                        <h1 id="count">0%</h1>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div id="mainContent">
            <div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 row-cols-xs-1 mt-3">
                <% for(let listing of allListings) { %>
                    <a href="/listings/<%= listing._id %>" class="listing-link">
                        <div class="card col listing-card">
                            <img src="<%= listing.image %>" class="card-img-top" alt="listing_img">
                            <div class="card-body">
                                <p class="card-text">
                                    <b><%= listing.title %></b><br />
                                    <%= listing.location %>
                                </p>
                            </div>
                        </div>
                    </a>
                <% } %>
            </div>
        </div>

        <!-- Bot icon (medium size) -->
        <div id="bot-icon" onclick="toggleBot()">ðŸ’¬</div>

        <!-- Bot iframe container -->
        <div id="bot-container">
            <!-- <iframe allow="microphone;" src="https://console.dialogflow.com/api-client/demo/embedded/e497957d-1eba-4467-8ee5-027547e162a4"></iframe> -->
            <iframe height="430" width="350" src="https://bot.dialogflow.com/e497957d-1eba-4467-8ee5-027547e162a4"></iframe>
        </div>

        <script>
            function loadingpage() {
                let tl = gsap.timeline();

                document.addEventListener("DOMContentLoaded", function () {
                    const loaderCount = document.querySelector(".loaderPage #count");

                    tl.from(".loaderPage .text-container .text", {
                        y: 100,
                        duration: 0.8,
                        stagger: 0.2,
                    });

                    tl.to(
                        {},
                        {
                            delay: 0.8,
                            duration: 0.4,
                            ease: "none",
                            onUpdate: function () {
                                const progress = Math.round(this.progress() * 10) * 10;
                                loaderCount.textContent = `${progress}%`;
                            },
                            onComplete: function () {
                                loaderCount.textContent = "100%";
                                document.querySelector(".loaderPage .wrapper").style.borderRadius = "10px";

                                tl.to(".loaderPage .wrapper", {
                                    onStart: () => {
                                        gsap.to(".loaderPage .text-container .text", {
                                            y: -120,
                                            duration: 0.7,
                                            stagger: 0.1,
                                        });
                                    },
                                    top: "70%",
                                    duration: 1.3,
                                    height: "0",
                                    ease: "power3.in",
                                    width: "85vw",
                                    onComplete: () => {
                                        document.querySelector("#splashScreen").style.display = "none";
                                        document.querySelector("#mainContent").style.display = "block"; // Show main content
                                        document.body.style.overflow = "auto"; // Re-enable scrolling
                                    },
                                });
                            },
                        }
                    );
                });
            }
            loadingpage();

            // Toggle the bot visibility
            function toggleBot() {
                const botContainer = document.getElementById('bot-container');
                if (botContainer.style.display === 'none') {
                    botContainer.style.display = 'block'; // Show bot
                } else {
                    botContainer.style.display = 'none'; // Hide bot
                }
            }
        </script>
    </body>
    </html>
